#!/usr/bin/env ruby

$LOAD_PATH << File.join(File.dirname(__FILE__), '..', 'lib')

require 'queueing_proxy'

EM.run{
  QueueingProxy {
    from('0.0.0.0', 10000)
    to('127.0.0.1', 10001)
    times(12)
    logger(Logger.new($stdout))
    queue_with('0.0.0.0', 'http-queue')
  }.run

  QueueingProxy {
    from('0.0.0.0', 10002)
    to('127.0.0.1', 10001)
    times(12)
    logger(Logger.new($stdout))
    queue_with('0.0.0.0', 'http-queue2')
  }.run
}